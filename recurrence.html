
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Recurrence Relations (Advanced) &#8212; Math Notes  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/classic.css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Stones and Sticks Principle" href="stonesSticks.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="stonesSticks.html" title="Stones and Sticks Principle"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Math Notes  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="combinatorics.html" >Combinatorics</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="stonesSticks.html" accesskey="U">Stones and Sticks Principle</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Recurrence Relations (Advanced)</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="recurrence-relations-advanced">
<h1>Recurrence Relations (Advanced)<a class="headerlink" href="#recurrence-relations-advanced" title="Permalink to this headline">¶</a></h1>
<p>The first three sections provide a flavor of recurrence relations. We pick up the thread on distributions from other sections in the fourth section on Stirling number.</p>
<section id="tower-of-hanoi">
<h2>Tower of Hanoi<a class="headerlink" href="#tower-of-hanoi" title="Permalink to this headline">¶</a></h2>
<p>The image below shows a classic problem where there are three pegs and a certain number of discs with distinct sizes (diameters). The discs are initially sitting on the first peg ordered by size. No disc is sitting above a disc that is smaller than its size. The objective is to move this stack of discs to the third peg following two rules: <strong>1) Only one disc can be moved at a time, and 2) A disc can only be placed onto an empty peg, or onto a larger disc.</strong> What is the least number of moves required to move a stack with <img class="math" src="_images/math/5a939c5280da7202ca4531f175a7780ad5e1f80a.png" alt="n"/> discs?</p>
<a class="reference internal image-reference" href="_images/tower_of_hanoi.png"><img alt="_images/tower_of_hanoi.png" src="_images/tower_of_hanoi.png" style="width: 150px;" /></a>
<p>If there is only <strong>1 disc</strong>, the move can be done in one step. We will denote this by <img class="math" src="_images/math/acb218a0319d9cbc66c18edb0d356aa3a795682f.png" alt="T(1)=1"/>.</p>
<p>If there are only <strong>2 discs</strong>, we will first move to the top small disc from peg A to peg B, then move the bottom large disc from peg A to peg C, and finally move the small disc from peg B to peg C. So we need <img class="math" src="_images/math/5b4475c83a242225b86b3862fc6b109cc32d7de7.png" alt="T(2)=3"/> moves.</p>
<a class="reference internal image-reference" href="_images/tower_of_hanoi_soln2.png"><img alt="_images/tower_of_hanoi_soln2.png" src="_images/tower_of_hanoi_soln2.png" style="width: 600px;" /></a>
<p>Note, even though we are highlighting the peg names, the whole idea is to move the disc stack to another peg using a third peg as a temporary holding place. In the general case, it does not matter if larger discs are already present on some pegs. The top of the stack consisting of two discs can still be moved using the same algorithm irrespective of if larger discs are already present on other pegs.</p>
<p>Now, suppose there are <strong>3 discs</strong>. We can move the stack of the top two discs to peg B using the recipe for 2 discs, move the largest of the 3 discs from peg A to peg C, and then move the 2 disc stack from peg B to peg C, again using the two disc recipe.</p>
<a class="reference internal image-reference" href="_images/tower_of_hanoi_soln3.png"><img alt="_images/tower_of_hanoi_soln3.png" src="_images/tower_of_hanoi_soln3.png" style="width: 600px;" /></a>
<p>Thus, <img class="math" src="_images/math/42a9eb944e459010183b690e8f3b34672544d88a.png" alt="T(3)=2\times T(2)+1"/>.</p>
<p>In fact, for any <img class="math" src="_images/math/4f4dac2099abc307369899aef3ea2043f2fb792a.png" alt="n (n&gt;1)"/>, <img class="math" src="_images/math/9b631cd871fb7d06d97dd8e9d74bea15ac331b36.png" alt="T(n+1)=2\times T(n)+1"/>. We can move the stack of the top <img class="math" src="_images/math/5a939c5280da7202ca4531f175a7780ad5e1f80a.png" alt="n"/> discs to peg B, then move the largest disc from peg A to peg C, and finally move the stack of the :math”<cite>n</cite> discs from peg B to peg C.</p>
<p>Thus, we can compute T(2) from T(1), T(3) from T(2), T(4) from T(3), and so on using our formula without actually thinking about all the moves. Such formulas that are applied successively are called recurrence relations.</p>
<p>There are ways to solve such a formula and get explicit non-recursive answers. For example, the tower of Hanoi formula gives</p>
<p><img class="math" src="_images/math/c63b5b5bef81d2485a353e666549875353d1735b.png" alt="T(n)=2^n-1"/>.</p>
<p>However, in this section, we do not worry about how to solve such recurrence relations. We are just highlighting the fact that such recurrence relations can be derived and successive application of such recurrence relations allows one to calculate counts for small arguments.</p>
</section>
<section id="fibonacci-sequence">
<h2>Fibonacci Sequence<a class="headerlink" href="#fibonacci-sequence" title="Permalink to this headline">¶</a></h2>
<p>Another well-known recurrence relation is for the Fibonacci problem. The details of the problem can be read <a class="reference external" href="https://en.wikipedia.org/wiki/Fibonacci_sequence#Europe">at this link</a>.</p>
<p>This results in the following recurrence relation:</p>
<div class="math">
<p><img src="_images/math/bbe446aef266ab14d30c7773509b98d8fea02481.png" alt="F(1)&amp;= 1

F(2)&amp;= 1

F(n)&amp;=F(n-1)+F(n)~\text{(For } n&gt;2 \text{ )}"/></p>
</div></section>
<hr class="docutils" />
<section id="combinations">
<h2>Combinations<a class="headerlink" href="#combinations" title="Permalink to this headline">¶</a></h2>
<p>In our discussion of basic combinatorics, we learnt that the number of ways of choosing <img class="math" src="_images/math/9630132210b904754c9ab272b61cb527d12263ca.png" alt="k"/> objects from <img class="math" src="_images/math/5a939c5280da7202ca4531f175a7780ad5e1f80a.png" alt="n"/> distinguishable objects is given by <img class="math" src="_images/math/aaef3d2a9265053cf2d39193d76446004e5d866c.png" alt="C(n,k)=\frac{n!}{(n-k)! k!}"/>.</p>
<p>We could make this choice in another way. Consider one of the <img class="math" src="_images/math/5a939c5280da7202ca4531f175a7780ad5e1f80a.png" alt="n"/> objects. There are two mutually exclusive possibilities. Either this object is chosen or the object is not chosen. If the object is chosen, then we only need to choose the remaining <img class="math" src="_images/math/80f9cec39846018c61106a1156a7b875d277a88c.png" alt="k-1"/> objects from <img class="math" src="_images/math/a44c09dc69d687fd66b7a1a12197c0299aa5db1c.png" alt="n-1"/> objects. If the object is not chosen, then we need to choose the <img class="math" src="_images/math/9630132210b904754c9ab272b61cb527d12263ca.png" alt="k"/> objects from <img class="math" src="_images/math/a44c09dc69d687fd66b7a1a12197c0299aa5db1c.png" alt="n-1"/> objects. Thus, applying the addition principle (corresponding to the <strong>or</strong> between the mutually exclusive events),</p>
<div class="math">
<p><img src="_images/math/d9776941177a25595fa6e2f359e33bc57c003354.png" alt="C(n,k) = C(n-1,k-1) + C(n-1,k)"/></p>
</div><p>This formula is known as Pascal’s rule.</p>
<p>Note that <img class="math" src="_images/math/0ecf139c47b2400a0978c474ef37c6789175e0b7.png" alt="C(n,0)=C(n,n)=1"/> for any <img class="math" src="_images/math/5a939c5280da7202ca4531f175a7780ad5e1f80a.png" alt="n"/>. There is only one way of not choosing any object or choosing all the objects. For other <img class="math" src="_images/math/9630132210b904754c9ab272b61cb527d12263ca.png" alt="k"/>, <img class="math" src="_images/math/8530f42f9a6d670d0c2193246856e1476948a5cf.png" alt="C(n,k)"/> can be obtained using the Pascal’s rule recursively.</p>
<div class="math">
<p><img src="_images/math/13683b57d9459ba84b2a45c98a8f0d2ccbeda157.png" alt="&amp; C(0,0)=1

&amp; C(1,0)=1,~C(1,1)=1

&amp; C(2,0)=1,~C(2,1)=C(1,0)+C(1,1)=1+1=2,~C(2,2)=1

&amp; C(3,0)=1,~C(3,1)=C(2,0)+C(2,1)=1+2=3,~C(3,2)=C(2,1)+C(2,2)=2+1=3,~C(3,3)=1"/></p>
</div><p>More details about the application of Pascal’s formula can be found <a class="reference external" href="https://en.wikipedia.org/wiki/Pascal%27s_triangle">here</a>.</p>
</section>
<section id="stirling-number">
<h2>Stirling Number<a class="headerlink" href="#stirling-number" title="Permalink to this headline">¶</a></h2>
<p>In our discussion of the <a class="reference internal" href="inclusionExclusion.html#distinguishable-distributions"><span class="std std-ref">inclusion-exclusion principle</span></a> , we had come across the following problem:</p>
<p>In how many ways can 12 <strong>distinguishable</strong> presents be given to three people such that every person gets at least one present and all the presents are given out?</p>
<p>We then encountered a variant of this problem in <a class="reference internal" href="stonesSticks.html#stones-and-sticks-principle"><span class="std std-ref">stones and sticks principle</span></a>.</p>
<p>In how many ways can 12 <strong>indistinguishable</strong> presents be given to three people such that every person gets at least one present and all the presents are given out?</p>
<p>Here we study the third variant where the presents are distinguishable, but the receivers of the presents are not. Replace the persons receiving with indistinguishable robots. Alternatively, we frame an equivalent problem.</p>
<p>In how many ways can 12 people sit at 3 tables if the tables can be considered indistinguishable, no table is empty, and every person sits at one of the tables? In other words, only the combination of people matters; the exact table they are sitting at does not matter for counting configurations. This number is denoted by <img class="math" src="_images/math/f47a34d852fd78d0ae28d04b344d983c9d7e9884.png" alt="S(12,3)"/> and is known as the Stirling number (of the second kind).</p>
<p>If tables can be empty, then the problem becomes one of finding <img class="math" src="_images/math/8f2feb7cee715d8bf2ee67c511638705b040ead4.png" alt="S(12,3)+S(12,2)+S(12,1)"/>.</p>
<p>This problem can be solved by using a recurrence relation.</p>
<p>Consider one of the 12 people. Either this person sits by himself at a table or shares the table with other people. If the person sits by himself, the other 11 people have to sit at 2 tables. Thus, the number of configurations for this case is <img class="math" src="_images/math/8bc1d0b2df4391a18bf467f78c13ea9d395befef.png" alt="S(11,2)"/>. However, if the person shares the table, then we first let the other people first sit at the 3 tables such that no table is empty (this can be done in <img class="math" src="_images/math/6f54ebc306d63e8ae81b54bf94b858e683e7399c.png" alt="S(11,3)"/> ways , and then add this person to one of the 3 tables (this can be done in 3 ways). Hence, <img class="math" src="_images/math/1ba62fd1e4d6fd31028a2f30b482b96a4e2dc41b.png" alt="S(12,3)=S(11,2)+3\times S(11,3)"/>.</p>
<p>For <img class="math" src="_images/math/cb297dec5c2a2a32e5fde8bc3a0cd39660f83adb.png" alt="n&gt;0,~S(n,1)=1"/> as there everyone has to sit at the only table available. For <img class="math" src="_images/math/06dd3c484b7aa5cdd2b9d74be5cf34d0c0e93099.png" alt="n&lt;k,~S(n,k)=0"/> as there are more tables than people. For <img class="math" src="_images/math/7bd748081c32e7d337ef6f8d4a88ca53270e57c1.png" alt="n&gt;0,~S(n,n)=1"/> as if there are same number of people as tables, there can be only one person per table to ensure that no table is empty.</p>
<p>In general (for <img class="math" src="_images/math/6204fb95f0d07eef72303e4afa7149a32b2986d2.png" alt="n&gt;1,~k&gt;1"/>):</p>
<div class="math">
<p><img src="_images/math/c8456be2201a4381460db3572a1f5e562d53a990.png" alt="&amp; S(n,k) = S(n-1,k-1) + k \times S(n-1,k)"/></p>
</div><p>This successive recursion becomes cumbersome for large numbers. Let us calculate this for a manageable case.</p>
<div class="math">
<p><img src="_images/math/8e68ffcfe1b78c1840f03eccf098870fb652e54d.png" alt="&amp;S(1,1) = 1

&amp;S(2,1) = 1

&amp;S(2,2)=S(1,1)+2S(1,2)=1+2\times 0 = 1

&amp;S(3,1) = 1

&amp;S(3,2)=S(2,1)+3S(2,2)=1+2\times 1=3

&amp;S(3,3)=S(2,2)+3S(2,3)=1+3\times 0=1

&amp;S(4,1) = 1

&amp;S(4,2)=S(3,1)+2S(3,2)=1+2\times 3=7

&amp;S(4,3)=S(3,2)+3S(3,3)=3+3\times 1=6

&amp;S(4,4)=S(3,3)+4S(3,4)=1+4\times 0=1"/></p>
</div></section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Recurrence Relations (Advanced)</a><ul>
<li><a class="reference internal" href="#tower-of-hanoi">Tower of Hanoi</a></li>
<li><a class="reference internal" href="#fibonacci-sequence">Fibonacci Sequence</a></li>
<li><a class="reference internal" href="#combinations">Combinations</a></li>
<li><a class="reference internal" href="#stirling-number">Stirling Number</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="stonesSticks.html"
                        title="previous chapter">Stones and Sticks Principle</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/recurrence.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="stonesSticks.html" title="Stones and Sticks Principle"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Math Notes  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="combinatorics.html" >Combinatorics</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="stonesSticks.html" >Stones and Sticks Principle</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Recurrence Relations (Advanced)</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2024, AI.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.1.2.
    </div>
  </body>
</html>